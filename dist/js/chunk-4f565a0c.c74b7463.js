(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f565a0c"],{2621:function(t,e){e.f=Object.getOwnPropertySymbols},"36bb":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"mt-3 d-flex"},[a("button",{staticClass:"btn btn-outline-success btn-sm d-flex align-items-center ml-auto",on:{click:function(e){t.openModal(!0)}}},[a("i",{staticClass:"material-icons"},[t._v("add")]),t._v("建立優惠券\n    ")])]),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-hover mt-3"},[t._m(0),a("tbody",{staticClass:"bg-white"},t._l(t.coupons,function(e){return a("tr",{key:e.id},[a("td",[t._v(t._s(e.title))]),a("td",[t._v(t._s(e.code))]),a("td",[t._v(t._s(e.percent))]),a("td",[t._v(t._s(t._f("timeTamps")(e.due_date)))]),a("td",[e.is_enabled?a("span",{staticClass:"text-success font-weight-bold"},[t._v("啟用")]):a("span",[t._v("未啟用")])]),a("td",[a("button",{staticClass:"btn btn-outline-main btn-sm mb-2 mb-md-0",on:{click:function(a){t.openModal(!1,e)}}},[t._v("編輯")]),a("button",{staticClass:"btn btn-outline-secondary btn-sm mb-2 mb-md-0",on:{click:function(a){t.deleteModal(e)}}},[t._v("刪除")])])])}),0)])]),a("pagination",{staticClass:"d-flex justify-content-center",attrs:{"page-data":t.pagination},on:{changepage:t.getCoupons}}),a("modal",{attrs:{id:"couponModal"}},[a("div",{staticClass:"modal-header bg-main text-white",attrs:{slot:"modalHeader"},slot:"modalHeader"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t.isNew?a("span",[a("i",{staticClass:"fas fa-folder-plus mr-1"}),t._v("新增優惠券")]):a("span",[a("i",{staticClass:"fas fa-edit mr-1"}),t._v("編輯優惠券")])]),a("button",{staticClass:"close text-white",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])]),a("div",{staticClass:"modal-body",attrs:{slot:"modalBody"},slot:"modalBody"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"couponName"}},[t._v("*優惠券名稱")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.title,expression:"tempCoupon.title"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("couponName")},attrs:{type:"text",id:"couponName",name:"couponName",placeholder:"請輸入優惠券名稱"},domProps:{value:t.tempCoupon.title},on:{input:function(e){e.target.composing||t.$set(t.tempCoupon,"title",e.target.value)}}}),t.errors.has("couponName")?a("span",{staticClass:"text-danger"},[t._v("請輸入優惠券名稱")]):t._e()]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"couponCode"}},[t._v("*優惠代碼")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.code,expression:"tempCoupon.code"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("couponCode")},attrs:{type:"text",id:"couponCode",name:"couponCode",placeholder:"請輸入優惠代碼"},domProps:{value:t.tempCoupon.code},on:{input:function(e){e.target.composing||t.$set(t.tempCoupon,"code",e.target.value)}}}),t.errors.has("couponCode")?a("span",{staticClass:"text-danger"},[t._v("請輸入優惠代碼")]):t._e()]),1==t.tempCoupon.is_enabled?a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"dueDate"}},[t._v("*到期日")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.due_date,expression:"tempCoupon.due_date"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("dueDate")},attrs:{type:"date",id:"dueDate",name:"dueDate"},domProps:{value:t.tempCoupon.due_date},on:{input:function(e){e.target.composing||t.$set(t.tempCoupon,"due_date",e.target.value)}}}),t.errors.has("dueDate")?a("span",{staticClass:"text-danger"},[t._v("請選擇到期日")]):t._e()]):t._e(),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"percent"}},[t._v("*折扣百分比")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.percent,expression:"tempCoupon.percent"},{name:"validate",rawName:"v-validate",value:{required:!0,alpha_num:!0,max_value:100},expression:"{ required: true, alpha_num: true, max_value:100  }"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("percent")},attrs:{type:"tel",id:"percent",name:"percent",placeholder:"請輸入折扣百分比"},domProps:{value:t.tempCoupon.percent},on:{input:function(e){e.target.composing||t.$set(t.tempCoupon,"percent",e.target.value)}}}),t.errors.has("percent")?a("span",{staticClass:"text-danger"},[t._v("請輸入101以內的正整數")]):t._e()]),a("div",{staticClass:"form-check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.is_enabled,expression:"tempCoupon.is_enabled"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"isEnabled","true-value":1,"false-value":0},domProps:{checked:Array.isArray(t.tempCoupon.is_enabled)?t._i(t.tempCoupon.is_enabled,null)>-1:t._q(t.tempCoupon.is_enabled,1)},on:{change:function(e){var a=t.tempCoupon.is_enabled,s=e.target,o=s.checked?1:0;if(Array.isArray(a)){var n=null,i=t._i(a,n);s.checked?i<0&&t.$set(t.tempCoupon,"is_enabled",a.concat([n])):i>-1&&t.$set(t.tempCoupon,"is_enabled",a.slice(0,i).concat(a.slice(i+1)))}else t.$set(t.tempCoupon,"is_enabled",o)}}}),a("label",{staticClass:"form-check-label",attrs:{for:"isEnabled"}},[t._v("是否啟用")])])])])]),a("div",{staticClass:"modal-footer",attrs:{slot:"modalFooter"},slot:"modalFooter"},[a("button",{staticClass:"btn btn-outline-secondary border-0",attrs:{type:"button","data-dismiss":"modal"}},[t._v("取消")]),a("button",{staticClass:"btn btn-becare text-main",attrs:{type:"button",disabled:t.status.loading},on:{click:t.updateCoupons}},[t.status.loading?a("i",{staticClass:"fas fa-spinner fa-spin mr-1"}):t._e(),t._v("確認\n      ")])])]),a("modal",{attrs:{id:"delCouponModal","modal-data":t.tempCoupon,isloading:t.status.loading},on:{doit:t.delCoupon}})],1)},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",{staticClass:"table-becare"},[a("tr",{staticClass:"text-nowrap"},[a("th",[t._v("名稱")]),a("th",[t._v("代碼")]),a("th",{attrs:{width:"100"}},[t._v("折扣 % ")]),a("th",{attrs:{width:"200"}},[t._v("到期日")]),a("th",{attrs:{width:"100"}},[t._v("是否啟用")]),a("th",{attrs:{width:"150"}},[t._v("操作")])])])}],n=(a("c5f6"),a("f751"),a("1157")),i=a.n(n),l={data:function(){return{coupons:[],pagination:{},tempCoupon:{},isNew:!1,status:{loading:!1}}},methods:{getCoupons:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("crossgate","/admin/coupons?page=").concat(t),a=this;a.$store.dispatch("updateLoading",!0),this.$http.get(e).then(function(t){t.data.success?(a.coupons=t.data.coupons,a.$store.dispatch("updateLoading",!1),a.pagination=t.data.pagination):(a.$bus.$emit("message:push",t.data.message,"danger"),setTimeout(function(){a.$router.push("/login")},1500))})},openModal:function(t,e){if(this.$validator.reset(),t)this.tempCoupon={},this.isNew=!0;else if(this.tempCoupon=Object.assign({},e),this.isNew=!1,1===this.tempCoupon.is_enabled){var a=new Date(1e3*Number(this.tempCoupon.due_date)),s=a.getFullYear()+"-",o=(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-",n=a.getDate()<10?"0"+a.getDate():a.getDate();this.tempCoupon.due_date=s+o+n}else this.tempCoupon.due_date="";i()("#couponModal").modal("show")},deleteModal:function(t){this.tempCoupon=Object.assign({},t),i()("#delCouponModal").modal("show")},updateCoupons:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("crossgate","/admin/coupon"),a=this,s="post";a.isNew||(e="".concat("https://vue-course-api.hexschool.io","/api/").concat("crossgate","/admin/coupon/").concat(a.tempCoupon.id),s="put"),this.$validator.validate().then(function(o){if(o){a.status.loading=!0;var n=Object.assign({},a.tempCoupon);if(1===a.tempCoupon.is_enabled){var l=new Date(a.tempCoupon.due_date);n.due_date=Math.floor(l/1e3)}else{var r=new Date("1970-01-01");n.due_date=Math.floor(r/1e3)}n.percent=Number(a.tempCoupon.percent),t.$http[s](e,{data:n}).then(function(t){t.data.success?(i()("#couponModal").modal("hide"),a.status.loading=!1,a.getCoupons(),a.$bus.$emit("message:push",t.data.message,"success")):(i()("#couponModal").modal("hide"),a.status.loading=!1,a.$bus.$emit("message:push",t.data.message,"danger"))})}else a.$bus.$emit("message:push","噢！表單內有欄位空白唷","danger")})},delCoupon:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("crossgate","/admin/coupon/").concat(t.tempCoupon.id);t.status.loading=!0,this.$http.delete(e).then(function(e){e.data.success?(i()("#delCouponModal").modal("hide"),t.status.loading=!1,t.$bus.$emit("message:push",e.data.message,"success"),t.getCoupons()):(i()("#delCouponModal").modal("hide"),t.status.loading=!1,t.$bus.$emit("message:push",e.data.message,"danger"))})}},created:function(){this.getCoupons()}},r=l,d=a("2877"),c=Object(d["a"])(r,s,o,!1,null,null,null);c.options.__file="coupon.vue";e["default"]=c.exports},7333:function(t,e,a){"use strict";var s=a("0d58"),o=a("2621"),n=a("52a7"),i=a("4bf8"),l=a("626a"),r=Object.assign;t.exports=!r||a("79e5")(function(){var t={},e={},a=Symbol(),s="abcdefghijklmnopqrst";return t[a]=7,s.split("").forEach(function(t){e[t]=t}),7!=r({},t)[a]||Object.keys(r({},e)).join("")!=s})?function(t,e){var a=i(t),r=arguments.length,d=1,c=o.f,u=n.f;while(r>d){var p,m=l(arguments[d++]),h=c?s(m).concat(c(m)):s(m),g=h.length,b=0;while(g>b)u.call(m,p=h[b++])&&(a[p]=m[p])}return a}:r},f751:function(t,e,a){var s=a("5ca1");s(s.S+s.F,"Object",{assign:a("7333")})}}]);
//# sourceMappingURL=chunk-4f565a0c.c74b7463.js.map